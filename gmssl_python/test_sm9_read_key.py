from gmssl import *

master = Sm9EncMasterKey()

enc_master_dHex = "000130E78459D78545CB54C587E02CF480CE0B66340F319F348A1D5B1F2DC5F4"
enc_master_pubHex =\
	"A5702F05CF1315305E2D6EB64B0DEB923DB1A0BCF0CAFF90523AC8754AA69820\n" \
	"78559A844411F9825C109F5EE3F52D720DD01785392A727BB1556952B2B013D3"
 
hex_deB = \
    "74CCC3AC9C383C60AF083972B96D05C75F12C8907D128A17ADAFBAB8C5A4ACF7\n" \
    "01092FF4DE89362670C21711B6DBE52DCD5F8E40C6654B3DECE573C2AB3D29B2\n" \
    "44B0294AA04290E1524FF3E3DA8CFD432BB64DE3A8040B5B88D1B5FC86A4EBC1\n" \
    "8CFC48FB4FF37F1E27727464F3C34E2153861AD08E972D1625FC1A7BD18D5539"

hex_RA = \
    "7CBA5B19069EE66AA79D490413D11846B9BA76DD22567F809CF23B6D964BB265\n" \
    "A9760C99CB6F706343FED05637085864958D6C90902ABA7D405FBEDF7B781599"
    
hex_ks = "000130E78459D78545CB54C587E02CF480CE0B66340F319F348A1D5B1F2DC5F4"
hex_ds = \
    "A5702F05CF1315305E2D6EB64B0DEB923DB1A0BCF0CAFF90523AC8754AA69820\n" \
    "78559A844411F9825C109F5EE3F52D720DD01785392A727BB1556952B2B013D3"

master.ke_from_hex(enc_master_dHex)
master.ppub_from_hex(enc_master_pubHex)
# master.generate_master_key()

master.print_key()

enc = Sm9EncKey("test")
enc.de_from_hex(hex_deB)
enc.ppub_from_hex(enc_master_pubHex)
enc.print_key()

sign_master = Sm9SignMasterKey()
sign_master.ks_from_hex(hex_ks)
sign_master.ppubs_from_hex(hex_deB)
sign_master.print_key()

sign_key = Sm9SignKey("test")
sign_key.ppubs_from_hex(hex_deB)
sign_key.ds_from_hex(hex_ds)
sign_key.print_key()